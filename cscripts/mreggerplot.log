-------------------------------------------------------------------------------
      name:  mreggerplot
       log:  /Users/tom/Documents/GitHub/mrrobust/cscripts/mreggerplot.log
  log type:  text
 opened on:  10 Apr 2023, 22:36:32

. * mreggerplot testcode
. * 6jun2016
. 
. cscript mreggerplot adofiles mreggerplot mregger
--------------------------------------------------------------BEGIN mreggerplot

-> which mreggerplot, usesysdir
/Users/tom/Documents/GitHub/mrrobust/mreggerplot.ado
*! version 0.1.0 Tom Palmer 06jun2016

-> which mregger, usesysdir
/Users/tom/Documents/GitHub/mrrobust/mregger.ado
*! version 0.1.0 04jun2016 Tom Palmer

. 
. use https://raw.github.com/remlapmot/mrrobust/master/dodata, clear

. 
. gen byte sel1 = (ldlcp2 < 1e-8)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(off)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(on)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(on) nolci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, gpci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis gpci" 
> == 198
nomcis and gpci options may not be specified together

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, gpci nolci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci nomcis

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci nomcis 
> gpci" == 198
nomcis and gpci options may not be specified together

. 
. // test passing own legend
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ///
>         legend(order(5 "Instruments" 4 "95% CIs" 3 "MR-Egger" 2 "MR-Egger 95%
>  CI"))

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop gpci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop nomcis

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop nomci
> s gpci" == 198
nomcis and gpci options may not be specified together

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop nolci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop nolci gpci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, linetop nolci nomcis

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, gpci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci linetop

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline linetop

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ellipses

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ellipses erro
> rbars" == 198
Options ellipses and errorbars cannot both be specified

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ivw ellipses 
> errorbars" == 198
Options ellipses and errorbars cannot both be specified

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, egger median"
>  == 198
only one of options egger or median allowed

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, egger

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ivw

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, median

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse, weighted" == 198
Please specify median with weighted or penweighted options

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse, penweighted" == 198
Please specify median with weighted or penweighted options

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, median weighted

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, median penweighted

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse, ivw median" == 198
only one of options ivw or median allowed

. 
. rcof "n mreggerplot chdbeta chdse ldlcbeta ldlcse, ivw egger" == 198
only one of options ivw or egger allowed

. 
. rcof "n mreggerplot chdbeta chdse ldlcbeta ldlcse, median egger" == 198
only one of options egger or median allowed

. 
. rcof "n mreggerplot chdbeta chdse ldlcbeta ldlcse, median egger ivw" == 198
only one of options ivw or egger allowed

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline egger

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline ivw

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline ivw linetop

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline median

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline median weighted

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, noline median penweight
> ed

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci egger

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci ivw

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis ivw

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis median

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(off)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis nolci legend(off
> )

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ellipses legend(off)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ellipses legend(off) li
> netop

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ellipses legend(off) no
> mcis

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nomcis

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, wmarkers

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, wmarkers egger

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, wmarkers median

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, wmarkers median weighte
> d

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, wmarkers median penweig
> hted

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, level(50)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, level(99)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, mlabel(rsid)

. 
. ** add ivw line to egger plot
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1

. mregger chdbeta ldlcbeta [aw=1/(chdse^2)], ivw

                                                     Number of genotypes = 185
                                              Residual standard error =  1.576
------------------------------------------------------------------------------
             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
chdbeta      |
    ldlcbeta |   .5042238    .058028     8.69   0.000     .3904911    .6179565
------------------------------------------------------------------------------

. addplot : function _b[ldlcbeta]*x, range(0 0.5) lc(gs0) lp(dash)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(off)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse in 1/3, ellipses

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ellipses

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ivw ellipses legend(off
> )

. 
. // titles
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, title("MR-Egger plot")

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, title(MR-Egger plot) //
> /
>         subtitle(Using MR-Base data)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ///
>         xtitle("Genotype-phenotype associations")

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ///
>         ytitle("Genotype-disease associations")

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ///
>         mleglabel(Genotypes)

. 
. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, ///
>         mleglabel("Genotypes")

. 
. rcof "noi mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, errorbars ell
> ipses" == 198
Options ellipses and errorbars cannot both be specified

. 
. // example labelling some points
. cap noi drop mlabvar
variable mlabvar not found

. gen mlabvar = rsid if abs(ldlcbeta) > .3
(183 missing values generated)

. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1, nolci ///
>         mlab(mlabvar) mlabsize(vsmall) mlabp(10) mlabc(gs0)

. 
end of do-file
      name:  mreggerplot
       log:  /Users/tom/Documents/GitHub/mrrobust/cscripts/mreggerplot.log
  log type:  text
 closed on:  10 Apr 2023, 22:37:15
-------------------------------------------------------------------------------
