-------------------------------------------------------------------------------
      name:  mrfunnel
       log:  /Users/tom/Documents/GitHub/mrrobust/cscripts/mrfunnel.log
  log type:  text
 opened on:  26 Sep 2025, 17:51:05

. * mrfunnel testcode
. * 29aug2017
. 
. cscript mrfunnel adofiles mrfunnel
-----------------------------------------------------------------BEGIN mrfunnel

-> which mrfunnel, usesysdir
/Users/tom/Documents/GitHub/mrrobust/mrfunnel.ado
*! 0.1.0 Tom Palmer 29aug2017

. 
. about

StataNow/MP 19.5 for Unix (Apple Silicon)
Revision 24 Sep 2025
Copyright 1985-2025 StataCorp LLC

Total usable memory: 16.00 GB

Stata license: Unlimited-user 2-core network, expiring 29 Jan 2026
Serial number: 501909307934
  Licensed to: Tom Palmer
               University of Bristol

. 
. use https://raw.github.com/remlapmot/mrrobust/master/dodata.dta, clear

. 
. gen byte sel1 = (ldlcp2 < 1e-8)

. 
. // web figure a2 of bowden et al., gen epi, 2016
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, metric(gpbeta)

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, metric(gpbetastd)

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, metric(invse)

. 
. rcof "mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, metric(wrongmetric)"
>  == 198

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, noivw

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, nomregger

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, noivw nomregger

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, xscale(range(-4 4))

. 
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, yscale(range(0 12))

. 
. discard

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, scatteropts(mc(red))

. 
. * legend off
. discard

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(off)

. 
. * lines going down to zero
. discard

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, ///
>         noivw nomregger ///
>         extraplots(function .481, lp(dash) lc(gs0) hor range(0 10) || ///
>                 function .617, lp(longdash) lc(gs0) hor range(0 10) || ) ///
>         legend(on order(1 "Genotypes" 2 "IVW" 3 "MR-Egger") rows(1))

. 
. * set the range for the lines using xlrange option
. discard

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, xlrange(0 10)

. 
. * original mrfunnel plot
. discard

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, xlrange(0 10) legend(off)

. 
. * Try different legend positions
. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(pos(6))

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(pos(12))

. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, legend(pos(3))

. 
end of do-file
      name:  mrfunnel
       log:  /Users/tom/Documents/GitHub/mrrobust/cscripts/mrfunnel.log
  log type:  text
 closed on:  26 Sep 2025, 17:51:10
-------------------------------------------------------------------------------
