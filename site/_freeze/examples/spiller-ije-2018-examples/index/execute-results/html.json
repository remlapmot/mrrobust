{
  "hash": "22d57059eeb59ebb628567d4ab22dee1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Examples from our IJE paper\"\n#author: \"Wes Spiller, Neil Davies, Tom Palmer\"\n#date: \"30 August 2018\"\nengine: knitr\n---\n\n\n\n\n\n\n\n\n\n\nThe paper is available [here](https://doi.org/10.1093/ije/dyy195) [@spiller-ije-2018].\n\n## mrrobust set-up\n\nInstall the `mrrobust` package using the user-written `github` package.\n\n```stata\nnet install github, from(\"https://haghish.github.io/github/\")\ngitget mrrobust\n```\n\nIf you have Stata 12 or earlier you will need to install some of these manually \n(see [here](https://remlapmot.github.io/mrrobust/#installing-and-updating-mrrobust) \nfor instructions).\n\n## Summary data description and overview\n\nAccompanying this paper are two sets of data _BMI.csv_, and _Height.csv_, containing the set of \nsummary estimates required for performing the BMI-serum glucose and height-serum glucose analyses \nrespectively. Each dataset is organised into 5 columns under the following headings:\n\n* `SNP`: A set of identifying numbers (rsids) for each genetic variant\n* `beta.exposure`: a set of values representing the coefficient from regressing the exposure upon \nthe genetic variant within a GWAS\n* `beta.outcome`: a set of values representing the coefficient from regressing the outcome upon \nthe genetic variant within a GWAS\n* `se.exposure`: a set of values representing the standard error corresponding to the coefficient \nin beta.exposure\n* `se.outcome`: a set of values representing the standard error corresponding to the coefficient \nin beta.outcome.\n\nNote Stata removes the `.` in the variable names when the data is imported.\n\nIn _BMI.csv_ the exposure is standardised body mass index (BMI), and is therefore interpreted on a\nstandard deviation scale. The summary statistics are reported by @locke-nat-2015.\nIn _Height.csv_ the exposure is standardised height in meters and also interpreted on a standard\ndeviation scale. The summary statistics are reported by @wood-natgen-2014.\n\nFor both analyses log transformed serum glucose was used as an outcome, reported by @shin-natgen-2014.\nAll the data was obtained from the MRBase GWAS catalogue available at <https://www.mrbase.org/> [@mrbase] which has now been superseeded by the [OpenGWAS API](https://api.opengwas.io/).\nGenetic variants were pruned so as to be independent ($R^2$ = 0.0001), and the effect alleles were \naligned between the exposure and outcome datasets using the MRBase web application, prior to \nimplementing `mrrobust`.\n\n## Stata output for each estimation method using mrrobust: BMI-Serum Glucose {#estimation}\n\n### Read in data\n\n\n\n\n::: {.cell layout-align=\"center\" collectcode='true'}\n\n```{.stata .cell-code}\nimport delimited using BMI.csv, clear\n```\n:::\n\n\n\n\n### IVW\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)], ivw\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                      Number of genotypes = 79\n                                              Residual standard error =  1.039\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\nbetaexposure |   .0231866   .0079957     2.90   0.004     .0075154    .0388578\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n### MR-Egger\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)]\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                      Number of genotypes = 79\n                                              Residual standard error =  1.046\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\n       slope |   .0218507   .0221852     0.98   0.325    -.0216315    .0653329\n       _cons |    .000038   .0005877     0.06   0.948    -.0011138    .0011897\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n### Plot of the MR-Egger model\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmreggerplot betaoutcome seoutcome betaexposure seexposure\nqui gr export mreggerplot-bmi.svg, width(600) replace\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Plot of the MR-Egger model for the BMI data.](mreggerplot-bmi.svg){fig-align='center' fig-alt='Plot of the MR-Egger model for the BMI data.'}\n:::\n:::\n\n\n\n\t\n### Weighted median\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmrmedian betaoutcome seoutcome betaexposure seexposure, weighted seed(300818)\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0339256   .0120248     2.82   0.005     .0103576    .0574937\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n## Stata output using the mode-based estimator using mrrobust: BMI-Serum Glucose {#mode}\n\nUsing the `mrmodalplot` command, modal estimates are calculated using bandwidths of 0.25,\n0.5, and 1 respectively. This command also produces three overlaid density plots for each\nvalue, as shown in the Figure.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmrmodalplot betaoutcome seoutcome betaexposure seexposure, lc(gs10 gs5 gs0) seed(300818) legend(pos(6))\nqui gr export mrmodalplot-bmi.svg, width(600) replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n                                                                     Phi = .25\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0374507   .0424036     0.88   0.377    -.0456588    .1205602\n------------------------------------------------------------------------------\n\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n                                                                      Phi = .5\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0416424   .0369758     1.13   0.260    -.0308289    .1141137\n------------------------------------------------------------------------------\n\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0431816   .0281684     1.53   0.125    -.0120274    .0983906\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Densities of the IV estimates using different values of phi.](mrmodalplot-bmi.svg){fig-align='center' fig-alt='Densities of the IV estimates using different values of phi.'}\n:::\n:::\n\n\n\n\n## Stata output for each estimation method using mrrobust: Height-Serum Glucose {#height}\n\n### Read in data\n\n\n\n\n::: {.cell layout-align=\"center\" collectcode='true'}\n\n```{.stata .cell-code}\nimport delimited using Height.csv, clear\n```\n:::\n\n\n\n\n### IVW\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)], ivw\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                     Number of genotypes = 367\n                                              Residual standard error =  1.044\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\nbetaexposure |   .0015412   .0033017     0.47   0.641      -.00493    .0080124\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n### MR-Egger\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)]\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                     Number of genotypes = 367\n                                              Residual standard error =  1.045\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\n       slope |  -.0025878   .0091178    -0.28   0.777    -.0204584    .0152828\n       _cons |   .0001338   .0002754     0.49   0.627     -.000406    .0006736\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n### Plot of the MR-Egger model\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmreggerplot betaoutcome seoutcome betaexposure seexposure\nqui gr export mreggerplot-height.svg, width(600) replace\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Plot of the MR-Egger model for the Height data.](mreggerplot-height.svg){fig-align='center' fig-alt='Plot of the MR-Egger model for the Height data.'}\n:::\n:::\n\n\n\n\n### Weighted median\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmrmedian betaoutcome seoutcome betaexposure seexposure, weighted seed(300818)\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |          0   .0052323     0.00   1.000    -.0102551    .0102551\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\n\n\n## Stata output using the mode-based estimator using mrrobust: Height-Serum Glucose {#height-mode}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.stata .cell-code}\nmrmodalplot betaoutcome seoutcome betaexposure seexposure, lc(gs10 gs5 gs0) seed(300818) legend(pos(6))\nqui gr export mrmodalplot-height.svg, width(600) replace\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n                                                                     Phi = .25\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0061368   .0245472     0.25   0.803    -.0419748    .0542484\n------------------------------------------------------------------------------\n\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n                                                                      Phi = .5\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0015595   .0212232     0.07   0.941    -.0400372    .0431561\n------------------------------------------------------------------------------\n\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |  -.0054772   .0149074    -0.37   0.713    -.0346952    .0237408\n------------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Densities of the IV estimates using different values of phi.](mrmodalplot-height.svg){fig-align='center' fig-alt='Densities of the IV estimates using different values of phi.'}\n:::\n:::\n\n\n\n\n## References\n\n::: {#refs}\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}