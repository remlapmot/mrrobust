[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "mrrobust",
    "section": "",
    "text": "Latest updates\nShort video introduction\nHelpfile examples\nOverview\nInstalling and updating mrrobust\nUnit tests\nAuthors\nHow to cite the mrrobust package\nReferences\nCollaboration\nAcknowledgements\n\n\n\nTo obtain the latest update please see the instructions below.\n\nApril 2023:\n\nImproved the alt text descriptions for the images in the README and package website, and also centred the images\nRemade the mrrobust website using Quarto\nUpdated the Sanderson et al., bioRxiv, 2020, doi reference to its published version Sanderson et al., Statistics in Medicine, 2021, doi\nReran certification scripts under latest Stata 17.0\n\nFebruary 2023:\n\nUpdated R Markdown example to use the CRAN version of the Statamarkdown package\n\nSeptember 2022:\n\nUpdated manual installation instructions\n\nFebruary 2022:\n\nRan cscripts under Stata 17.0\nUpdated website examples to run under Stata 17.0\n\nSeptember 2021:\n\nChanged relevant http: URLs to https:\nMinor edits to the helpfiles\n\nJune 2021:\n\nPublished an interactive Code Ocean capsule demonstrating the use of the mrrobust package here\nBy default mrforest now specifies a fixed effect standard error for its IVW estimate\n\nApril 2021:\n\nAdded the I-squared statistic and its 95% CI to the mregger ..., heterogi output\n\nFebruary 2021:\n\nFixes to mrforest and mrleaveoneout related to the recent update to metan. mrforest and mrleaveoneout now use metan9 instead of metan because of the changes to metan syntax. No change was necessary in the dependency scripts because metan9 is also installed with ssc install metan\nChecked cscripts pass\nChecked examples on website run. And changed the 2 examples which use the TwoSampleMR R package to use the new ID code for the exposure data\nUpdated dependency.do to make it more robust to the more frequent updates to metan\nUpdated mrdeps to make it more robust to the more frequent updates to metan\n\nOctober 2020:\n\ndependency.do and mrdeps now install the updated version of the moremata package\nChecked the cscripts run under Stata 16.1\nAdded description of Q-statistic as Cochran’s and Ruecker’s for the IVW and MR-Egger models respectively\nIn various helpfiles added clarification that genotype-disease stands for SNP-outcome (or indeed instrument-outcome) and that genotype-phenotype stands for SNP-exposure (or indeed instrument-exposure) respectively; i.e. the estimates required for the top and bottom of the IV Wald ratio estimate\n\nAugust 2020:\n\nAdded html versions of the helpfiles to the website. These are available from the Helpfiles website menu bar item\nAdded extra decimal places examples to helpfiles of mrforest and mrleaveoneout\nmrfunnel now includes a legend on its plot\n\nJuly 2020:\n\nAdded gxse() option to mrmvivw to return instrument strength QA statistic for instrument validity in e(Qa) (Sanderson et al. 2019)\nThe gxse() option additionally returns the Qx and conditional F-statistics for each phenotype for instrument strength in e(Qx) and e(Fx) (Sanderson et al. 2020)\nAdded tdist option to mrmvivw and mrmvegger\nmrmvivw and mrmvegger now ereturn the RMSE in e(phi)\nmregger, ivw now displays the square root of the residual variance (residual standard error) and ereturns this is e(phi)\nChecked that examples on website still run\nAdded mrleaveoneout command to perform leave one out analysis\n\nJune 2020:\n\nSimplified the outcome variable name in mregger b and V e-returned matrices. Turn this off with new oldnames option\nAdded basic multivariable MR-Egger command, mrmvegger\nAdded basic multivariable IVW command, mrmvivw (currently command names mvmr and mvivw also work)\n\nFebruary 2020:\n\nUpdated contact details\nMinor edits to helpfiles, to show examples setting seed() option where helpful\nFixed mregger bug where r(table) was not returned with the gxse or heterogi options. The output for these options now appears before the coefficient table.\nMinor amendments to formatting of mregger gxse output\nmregger now ereturns e(phi), the scale parameter, in some cases\n\nJanuary 2020:\n\nmregger now additionally returns r(table)\nCertification scripts: added master.do and renamed and edited a few scripts\nAdded mr command. Commands may now be run as either mr egger ... or as previously mregger ....\nBest of IJE 2019!\nmrmedian, mrmedianobs, mreggersimex, mrmodal, and mrratio now additionally return the r(table) matrix (the information from the coefficient table)\nAdded an example showing how you can save and export your estimates using r(table), see here\n\nDecember 2019:\n\nAdded Q_GX to ereturn and display output when gxse() option specified to mregger\nChanged Q_GX and I^2_GX output to use first order weights in mregger output. This matches the output from the mr_egger() function in the MendelianRandomization R package. Use the unwi2gx option to report the unweighted statistics.\n\nJuly 2019:\n\nChecked that examples on website still run\n\nDecember 2018:\n\nImproved compatibility with the github Stata package, i.e., mrrobust and its dependencies can be installed simply by issuing: gitget mrrobust, if you have the github package installed. See below for instructions.\nmrdeps command added for conveniently installing dependencies\n\nNovember 2018:\n\nExample showing the use of the TwoSampleMR R package and mrrobust in the same R Markdown script (.Rmd file) is here\nExample showing the use of the TwoSampleMR R package and mrrobust in the same Stata Markdown script (.stmd file) is here\n\nSeptember 2018:\n\nIJE paper published online here\n\nAugust 2018:\n\nClick here for the example code and output from our IJE article\n\nMay 2018:\n\nClick here for code and output from the examples in the helpfiles\nThis page is now rendered on GitHub Pages here\n\nApril 2018:\n\nmregger now has option radial which implements the radial formulation of the MR-Egger model, and of the IVW model when used with option ivw\n\n\n\n\n\nClick here for a short video demonstrating the use of the package.\n\n\n\n\n\n\nClick here for some of the code and output from the examples in the helpfiles.\nOnce the package is installed, there is a summary helpfile which can be viewed in Stata with:\nhelp mrrobust\nThis has links to the helpfile for each command, which has an example near the bottom. In these examples you can click on the code to run it.\n\n\n\nThe mrrobust package is a collection of commands for performing two-sample Mendelian randomization analyses using summary data of genotype-phenotype and genotype-outcome associations.\nSuch data can be obtained from repositories such as MR-Base https://www.mrbase.org (Hemani et al. 2016).\nThe package contains the following commands:\n\nmrdeps installs dependencies for the package\nmrratio implements the standard instrumental variable ratio (Wald) estimate with a choice of standard errors/confidence intervals\nmrivests automates calling mrratio on all the selected genotypes in your dataset\nmregger implements the IVW and MR-Egger regression approaches introduced in Bowden et al. (2015)\nmreggersimex implements the simulation extrapolation algorithm for the MR-Egger model\nmreggerplot implements a scatter plot with fitted line (either from IVW, MR-Egger, or weighted median estimators) and confidence interval\nmrmedian and mrmedianobs implement the unweighted, weighted, and penalized weighted median IV estimators robust to 50% invalid instruments in Bowden et al. (2016)\nmrmodal implements the zero modal estimator of Hartwig et al. (2017)\nmrmodalplot plot of density used in modal estimator\nmrforest implements a forest plot of genotype specific IV estimates and estimates from models (e.g. IVW and MR-Egger)\nmrfunnel funnel plot of genotype specific IV estimates\nmr acts as a primary command, e.g. so the other commands can be run as mr egger ... as well as mregger ...\nmrmvivw (mvmr, mvivw) implements the multivariable IVW model\nmrmvegger implements the multivariable MR-Egger model\nmrleaveoneout implements leave one (genotype) out analysis\n\n\n\n\nTo install mrrobust in Stata versions 13 and later you have two choices.\n\n\nnet install mrrobust, from(\"https://raw.github.com/remlapmot/mrrobust/master/\") replace\nmrdeps\nIn this code mrdeps installs the dependencies. These are addplot, kdens, and moremata packages (all by Ben Jann), the heterogi command (Orsini et al.), the metan command (Harris et al.), and the grc1leg command (Wiggins).\nIf you have previously installed the package and the net install command above fails with an error message that there are two copies of the package installed simply run adoupdate.\nTo check if there is an update available to any of your user-written Stata packages run adoupdate. To update mrrobust run:\nadoupdate mrrobust, update\nTo uninstall mrrobust, issue in Stata:\nado uninstall mrrobust\nIf this fails with an error message mentioning that you have “multiple citations/instances of the package installed” simply issue adoupdate mrrobust. This should leave you with the most recent version of the package you previously installed. You can then run ado uninstall mrrobust.\n\n\n\nnet install github, from(\"https://haghish.github.io/github/\")\ngitget mrrobust\nThis automatically installs the dependencies.\nTo update the package issue:\ngithub update mrrobust\nTo uninstall mrrobust issue:\ngithub uninstall mrrobust\n\n\n\nThe net install syntax for installing mrrobust does not work under Stata version 12 and earlier because this webpage has an address starting with https rather than http. In such cases you need to do a manual installation.\n\n\n\nClick the green “Clone or download” button at the top of the GitHub repository here and download as a zip archive or click this direct link.\nIn your file explorer extract the zip archive and find its filepath, e.g. C:\\Users\\tom\\Downloads\\mrrobust-master\\mrrobust-master\nIn Stata run\nnet install mrrobust, from(\"C:\\Users\\tom\\Downloads\\mrrobust-master\\mrrobust-master\") replace\n\nThe installation commands for the other dependencies should work. However, if you need to install them manually their zip archives are available at the following links (extract the files from the downloaded zip archives and place them in your PERSONAL directory on your adopath):\n\nthe moremata package is available as a zip file here\nthe addplot command is available here\nthe heterogi command is available here\nthe kdens command is available here\nthe metan command is available here\nthe grc1leg command can be installed with\nnet install grc1leg, from(\"https://www.stata.com/users/vwiggins\")\n\n\n\n\n\n\nAs far as I know, and unlike R which has the testthat package (and other testing packages), there is no recognised standard for writing unit tests for Stata commands. StataCorp. refer to do-files with tests as cscripts (certification scripts). I publish my cscripts (and their log files of output) in the cscripts directory.\n\n\n\nTom Palmer tom.palmer@bristol.ac.uk, Wesley Spiller, Neil Davies\n\n\n\nSpiller W, Davies NM, Palmer TM. Software Application Profile: mrrobust — A tool for performing two-sample summary Mendelian randomization analyses. International Journal of Epidemiology, 2019, 48, 3, 684–690. https://doi.org/10.1093/ije/dyy195.\nThank you to all our users who have cited mrrobust. We made The Best of IJE 2019!\n\n\n\nIf you would like to extend the code or add new commands I am open to receiving pull requests on GitHub or send me an email to tom.palmer@bristol.ac.uk.\n\n\n\n\nBowden J, Davey Smith G, Burgess S. Mendelian randomization with invalid instruments: effect estimation and bias detection through Egger regression. International Journal of Epidemiology, 2015, 44, 2, 512–525. https://dx.doi.org/10.1093/ije/dyv080.\nBowden J, Davey Smith G, Haycock PC, Burgess S. Consistent estimation in Mendelian randomization with some invalid instruments using a weighted median estimator. Genetic Epidemiology, 2016, 40, 4, 304–314. https://dx.doi.org/10.1002/gepi.21965.\nHartwig FP, Davey Smith G, Bowden J. Robust inference in two-sample Mendelian randomisation via the zero modal pleiotropy assumption. International Journal of Epidemiology, 2017, 46, 6, 1985–1998. https://doi.org/10.1093/ije/dyx102.\nHemani G et al. The MR-Base platform supports systematic causal inference across the human phenome. eLife, 2018, 7:e34408. https://doi.org/10.7554/eLife.34408.001.\nSanderson E, Davey Smith G, Windmeijer F, Bowden J. An examination of multivariable Mendelian randomization in the single-sample and two-sample summary data settings. International Journal of Epidemiology, 2019, 48, 3, 713–727. https://doi.org/10.1093/ije/dyy262.\nSanderson E, Spiller W, Bowden J. Testing and correcting for weak and pleiotropic instruments in two-sample multivariable Mendelian randomization. Statistics in Medicine, 2021, 40, 25, 5434–5452. https://doi.org/10.1002/sim.9133.\n\n\n\n\nThanks for helpful feedback and suggestions to (in no particular order): Jasmine Khouja, Michael Holmes, Caroline Dale, Amy Taylor, Rebecca Richmond, Judith Brand, Yanchun Bao, Kawthar Al-Dabhani, Michalis Katsoulis, Ghazaleh Fatemifar, Lai-Te Chen, Sean Harrison, Emma Anderson, Cassianne Robinson-Cohen, Alisa Kjaergaard, and Steve Burgess."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "This is the website for the mrrobust Stata package\nGitHub repo: https://github.com/remlapmot/mrrobust"
  },
  {
    "objectID": "examples/rmarkdown-call-stata-example/index.html",
    "href": "examples/rmarkdown-call-stata-example/index.html",
    "title": "mrrobust",
    "section": "",
    "text": "This example shows how to run R and Stata code within the same R Markdown (.Rmd) file using the Statamarkdown R package. More information about this package is available here and here. To install this package and load it into your current R session run the following in R.\n# install.packages(\"Statamarkdown\") # uncomment on first run\nlibrary(Statamarkdown)\nNote when writing our Stata code chunks we need to be careful when we specify the collectcode=TRUE code chunk option, because each Stata code chunk is run as a separate batch job. For example, we include this chunk option in a chunk which reads in a dataset which we wish to use in subsequent chunks.\nUsing R and Stata code in the same script means that we can use the functions provided by the TwoSampleMR package to obtain data from MR-Base (Hemani et al. 2018).\nNext we install the other required packages in R.\nremotes::install_github(\"MRCIEU/TwoSampleMR\")\nremotes::install_github(\"MRCIEU/MRInstruments\")\ninstall.packages(\"foreign\")\n\n\n\n---\ntitle: Using mrrobust in an R Markdown or Quarto document\n---\n\n## Extracting data from MR-Base\n\nWe will be running the script from the MR-Base paper \n([Hemani et al., 2018](https://doi.org/10.7554/eLife.34408)).\nThe R code we will use is from\n[here](https://raw.githubusercontent.com/explodecomputer/mr-base-methods-paper/master/scripts/ldl-chd.R).\n\nWe load the packages into our R session.\nNote that the **foreign** package provides the `write.dta()` function\nwhich we will use to save the data in Stata format.\n```{r}\nlibrary(TwoSampleMR)\nlibrary(MRInstruments)\nlibrary(foreign)\n```\n\n\nWe can access the data using the **MRInstruments** package.\n\n```{r}\ndata(gwas_catalog)\n\n# Get published SNPs for LDL cholesterol\nldl_snps <-\n  subset(gwas_catalog,\n    grepl(\"LDL choles\", Phenotype) & Author == \"Willer CJ\")$SNP\n\n# Extract from GLGC dataset\nexposure <-\n  convert_outcome_to_exposure(\n    extract_outcome_data(ldl_snps, \"ieu-a-300\"))\n\n# Get outcome data from Cardiogram 2015\noutcome <- extract_outcome_data(exposure$SNP, \"ieu-a-7\")\n\n# Harmonise exposure and outcome datasets\n# Assume alleles are on the forward strand\ndat <- harmonise_data(exposure, outcome, action = 1)\n```\n\nAt this point we have our harmonised genotype-exposure and genotype-outcome\nassociation data saved in an object in our R session called `dat`.\n\nThe next two code chunks perform the analysis in R.\n\n```{r}\n# Perform MR analysis\nmr(dat)\nmr_heterogeneity(dat)\ndat$exposure <- \"LDL cholesterol\"\ndat$outcome <- \"Coronary heart disease\"\n\n# Label outliers and create plots\ndat$labels <- dat$SNP\ndat$labels[! dat$SNP %in% c(\"rs11065987\", \"rs1250229\", \"rs4530754\")] <- NA\n```\n\n\nTo proceed in Stata we can save our `dat` object as a Stata dataset\n\n```{r}\nwrite.dta(dat, file = \"dat.dta\")\n```\n\n\n## Analysis in Stata using the mrrobust package\n\nAt this point in Stata install the **mrrobust** package and its\ndependencies if you have not done so previously.\n```stata\nnet install github, from(\"https://haghish.github.io/github/\")\ngitget mrrobust\n```\n\nWe now read the dataset into Stata and look at the variable names\nand the number of observations.\n\n```{stata, collectcode=TRUE}\nqui use dat, clear\n```\n\n```{stata}\nds, v(28)\n```\n\n```{stata}\ndi _N\n```\n\n\nWe can then run the IVW model using `mregger` with fixed effect standard errors.\n\n```{stata}\nmregger beta_outcome beta_exposure [aw=1/(se_outcome^2)], ivw fe\n```\n\n\nWe then fit the MR-Egger, median, and modal based estimators.\n\n```{stata}\nmregger beta_outcome beta_exposure [aw=1/(se_outcome^2)]\n```\n\n```{stata}\nmrmedian beta_outcome se_outcome beta_exposure se_exposure, weighted\n```\n\n```{stata}\nmrmodal beta_outcome se_outcome beta_exposure se_exposure, weighted\n```\n\n\nAnd we could continue with additional Stata code (or indeed R code) as we like.\nTo run this R Markdown file, either; open it in RStudio and click the Knit button in the toolbar of the Source code window, or run\nrmarkdown::render('rmarkdown-call-stata-example.Rmd')\n\n\n\n\n\nHemani, Gibran, Jie Zheng, Benjamin Elsworth, Kaitlin H Wade, Valeriia Haberland, Denis Baird, Charles Laurin, et al. 2018. “The MR-Base platform supports systematic causal inference across the human phenome.” eLife 7: e34408. https://doi.org/10.7554/eLife.34408."
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html",
    "href": "examples/spiller-ije-2018-examples/index.html",
    "title": "Examples from our IJE paper",
    "section": "",
    "text": "The paper is available here (Spiller, Davies, and Palmer 2018)."
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#mrrobust-set-up",
    "href": "examples/spiller-ije-2018-examples/index.html#mrrobust-set-up",
    "title": "Examples from our IJE paper",
    "section": "mrrobust set-up",
    "text": "mrrobust set-up\nInstall the mrrobust package using the user-written github package.\nnet install github, from(\"https://haghish.github.io/github/\")\ngitget mrrobust\nIf you have Stata 12 or earlier you will need to install some of these manually (see here for instructions)."
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#summary-data-description-and-overview",
    "href": "examples/spiller-ije-2018-examples/index.html#summary-data-description-and-overview",
    "title": "Examples from our IJE paper",
    "section": "Summary data description and overview",
    "text": "Summary data description and overview\nAccompanying this paper are two sets of data BMI.csv, and Height.csv, containing the set of summary estimates required for performing the BMI-serum glucose and height-serum glucose analyses respectively. Each dataset is organised into 5 columns under the following headings:\n\nSNP: A set of identifying numbers (rsids) for each genetic variant\nbeta.exposure: a set of values representing the coefficient from regressing the exposure upon the genetic variant within a GWAS\nbeta.outcome: a set of values representing the coefficient from regressing the outcome upon the genetic variant within a GWAS\nse.exposure: a set of values representing the standard error corresponding to the coefficient in beta.exposure\nse.outcome: a set of values representing the standard error corresponding to the coefficient in beta.outcome.\n\nNote Stata removes the . in the variable names when the data is imported.\nIn BMI.csv the exposure is standardised body mass index (BMI), and is therefore interpreted on a standard deviation scale. The summary statistics are reported by Locke et al. (2015). In Height.csv the exposure is standardised height in meters and also interpreted on a standard deviation scale. The summary statistics are reported by Wood et al. (2014).\nFor both analyses log transformed serum glucose was used as an outcome, reported by Shin et al. (2014). All the data was obtained from the MRBase GWAS catalogue available at https://www.mrbase.org/ (Hemani et al. 2018). Genetic variants were pruned so as to be independent (\\(R^2\\) = 0.0001), and the effect alleles were aligned between the exposure and outcome datasets using the MRBase web application, prior to implementing mrrobust."
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#estimation",
    "href": "examples/spiller-ije-2018-examples/index.html#estimation",
    "title": "Examples from our IJE paper",
    "section": "Stata output for each estimation method using mrrobust: BMI-Serum Glucose",
    "text": "Stata output for each estimation method using mrrobust: BMI-Serum Glucose\n\nRead in data\n\nimport delimited using BMI.csv, clear\n\n\n\nIVW\n\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)], ivw\n\n                                                      Number of genotypes = 79\n                                              Residual standard error =  1.039\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\nbetaexposure |   .0231866   .0079957     2.90   0.004     .0075154    .0388578\n------------------------------------------------------------------------------\n\n\n\n\nMR-Egger\n\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)]\n\n                                                      Number of genotypes = 79\n                                              Residual standard error =  1.046\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\n       slope |   .0218507   .0221852     0.98   0.325    -.0216315    .0653329\n       _cons |    .000038   .0005877     0.06   0.948    -.0011138    .0011897\n------------------------------------------------------------------------------\n\n\n\n\nPlot of the MR-Egger model\n\nmreggerplot betaoutcome seoutcome betaexposure seexposure\nqui gr export mreggerplot-bmi.svg, width(600) replace\n\n\n\n\n\n\n\n\n\nPlot of the MR-Egger model for the BMI data.\n\n\n\n\n\n\nWeighted median\n\nmrmedian betaoutcome seoutcome betaexposure seexposure, weighted seed(300818)\n\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0339256   .0120248     2.82   0.005     .0103576    .0574937\n------------------------------------------------------------------------------"
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#mode",
    "href": "examples/spiller-ije-2018-examples/index.html#mode",
    "title": "Examples from our IJE paper",
    "section": "Stata output using the mode-based estimator using mrrobust: BMI-Serum Glucose",
    "text": "Stata output using the mode-based estimator using mrrobust: BMI-Serum Glucose\nUsing the mrmodalplot command, modal estimates are calculated using bandwidths of 0.25, 0.5, and 1 respectively. This command also produces three overlaid density plots for each value, as shown in the Figure.\n\nmrmodalplot betaoutcome seoutcome betaexposure seexposure, lc(gs10 gs5 gs0) seed(300818)\nqui gr export mrmodalplot-bmi.svg, width(600) replace\n\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n                                                                     Phi = .25\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0374507   .0424036     0.88   0.377    -.0456588    .1205602\n------------------------------------------------------------------------------\n\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n                                                                      Phi = .5\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0416424   .0369758     1.13   0.260    -.0308289    .1141137\n------------------------------------------------------------------------------\n\n                                                      Number of genotypes = 79\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0431816   .0281684     1.53   0.125    -.0120274    .0983906\n------------------------------------------------------------------------------\n\n\n\n\n\n\n\nDensities of the IV estimates using different values of phi."
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#height",
    "href": "examples/spiller-ije-2018-examples/index.html#height",
    "title": "Examples from our IJE paper",
    "section": "Stata output for each estimation method using mrrobust: Height-Serum Glucose",
    "text": "Stata output for each estimation method using mrrobust: Height-Serum Glucose\n\nRead in data\n\nimport delimited using Height.csv, clear\n\n\n\nIVW\n\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)], ivw\n\n                                                     Number of genotypes = 367\n                                              Residual standard error =  1.044\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\nbetaexposure |   .0015412   .0033017     0.47   0.641      -.00493    .0080124\n------------------------------------------------------------------------------\n\n\n\n\nMR-Egger\n\nmregger betaoutcome betaexposure [aw=1/(seoutcome^2)]\n\n                                                     Number of genotypes = 367\n                                              Residual standard error =  1.045\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nbetaoutcome  |\n       slope |  -.0025878   .0091178    -0.28   0.777    -.0204584    .0152828\n       _cons |   .0001338   .0002754     0.49   0.627     -.000406    .0006736\n------------------------------------------------------------------------------\n\n\n\n\nPlot of the MR-Egger model\n\nmreggerplot betaoutcome seoutcome betaexposure seexposure\nqui gr export mreggerplot-height.svg, width(600) replace\n\n\n\n\n\n\n\n\n\nPlot of the MR-Egger model for the Height data.\n\n\n\n\n\n\nWeighted median\n\nmrmedian betaoutcome seoutcome betaexposure seexposure, weighted seed(300818)\n\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |          0   .0052323     0.00   1.000    -.0102551    .0102551\n------------------------------------------------------------------------------"
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#height-mode",
    "href": "examples/spiller-ije-2018-examples/index.html#height-mode",
    "title": "Examples from our IJE paper",
    "section": "Stata output using the mode-based estimator using mrrobust: Height-Serum Glucose",
    "text": "Stata output using the mode-based estimator using mrrobust: Height-Serum Glucose\n\nmrmodalplot betaoutcome seoutcome betaexposure seexposure, lc(gs10 gs5 gs0) seed(300818)\nqui gr export mrmodalplot-height.svg, width(600) replace\n\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n                                                                     Phi = .25\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0061368   .0245472     0.25   0.803    -.0419748    .0542484\n------------------------------------------------------------------------------\n\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n                                                                      Phi = .5\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .0015595   .0212232     0.07   0.941    -.0400372    .0431561\n------------------------------------------------------------------------------\n\n                                                     Number of genotypes = 367\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |  -.0054772   .0149074    -0.37   0.713    -.0346952    .0237408\n------------------------------------------------------------------------------\n\n\n\n\n\n\n\nDensities of the IV estimates using different values of phi."
  },
  {
    "objectID": "examples/spiller-ije-2018-examples/index.html#references",
    "href": "examples/spiller-ije-2018-examples/index.html#references",
    "title": "Examples from our IJE paper",
    "section": "References",
    "text": "References\n\n\nHemani, Gibran, Jie Zheng, Benjamin Elsworth, Kaitlin H Wade, Valeriia Haberland, Denis Baird, Charles Laurin, et al. 2018. “The MR-Base platform supports systematic causal inference across the human phenome.” eLife 7: e34408. https://doi.org/10.7554/eLife.34408.\n\n\nLocke, Adam E, Bratati Kahali, Sonja I Berndt, Anne E Justice, Tune H Pers, Felix R Day, Corey Powell, et al. 2015. “Genetic Studies of Body Mass Index Yield New Insights for Obesity Biology.” Nature 518 (7538): 197–206. https://doi.org/10.1038/nature14177.\n\n\nShin, So-Youn, Eric B Fauman, Ann-Kristin Petersen, Jan Krumsiek, Rita Santos, Jie Huang, Matthias Arnold, et al. 2014. “An Atlas of Genetic Influences on Human Blood Metabolites.” Nature Genetics 46 (6): 543–50. https://doi.org/10.1038/ng.2982.\n\n\nSpiller, Wes, Neil M Davies, and Tom M Palmer. 2018. “Software application profile: mrrobust—a tool for performing two-sample summary Mendelian randomization analyses.” International Journal of Epidemiology 48 (3): 684–90. https://doi.org/10.1093/ije/dyy195.\n\n\nWood, Andrew R, Tonu Esko, Jian Yang, Sailaja Vedantam, Tune H Pers, Stefan Gustafsson, Audrey Y Chu, et al. 2014. “Defining the Role of Common Variation in the Genomic and Biological Architecture of Adult Human Height.” Nature Genetics 46 (11): 1173–86. https://doi.org/10.1038/ng.3097."
  },
  {
    "objectID": "examples/mrrobust-examples/index.html",
    "href": "examples/mrrobust-examples/index.html",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "",
    "text": "net install github, from(\"https://haghish.github.io/github/\")\ngitget mrrobust"
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#read-in-example-data",
    "href": "examples/mrrobust-examples/index.html#read-in-example-data",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "Read in example data",
    "text": "Read in example data\nRead in example data from Do et al. (2013).\n\nuse https://raw.github.com/remlapmot/mrrobust/master/dodata, clear\n\nSelect observations (p-value with exposure < 10-8).\n\ngen byte sel1 = (ldlcp2 < 1e-8)"
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mrforest-examples",
    "href": "examples/mrrobust-examples/index.html#mrforest-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mrforest examples",
    "text": "mrforest examples\nForest plot of genotype specific IV estimates and IVW and MR-Egger estimates, labelling the genotypes with their RSID.\n\nmrforest chdbeta chdse ldlcbeta ldlcse if sel1==1, ivid(rsid) ///\n    xlabel(-5,-4,-3,-2,-1,0,1,2,3,4,5)\nqui gr export mrforest.svg, width(600) replace\n\n\n\n\n\n\nExample forest plot of genotype specific IV estimates."
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mregger-examples",
    "href": "examples/mrrobust-examples/index.html#mregger-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mregger examples",
    "text": "mregger examples\nUsing the data provided by Do et al. (2013) recreate from Bowden et al. (2016) the Table 4, LDL-c “All genetic variants” estimates.\nIVW (with fixed effect standard errors, i.e. variance of residuals [residual variance] constrained to 1).\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, ivw fe\n\n                                                      Number of genotypes = 73\n                                      Residual standard error constrained at 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173\n------------------------------------------------------------------------------\n\n\nMR-Egger (with SEs using an unconstrained residual variance [multiplicative random effects]).\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1\n\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.548\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n       slope |   .6173131   .1034573     5.97   0.000     .4145405    .8200858\n       _cons |  -.0087706   .0054812    -1.60   0.110    -.0195136    .0019723\n------------------------------------------------------------------------------\n\n\nMR-Egger reporting I2GX statistic and heterogeneity Q-test.\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, gxse(ldlcse) heterogi\n\n                                           Q_GX statistic (weighted) = 3454.26\n                                         I^2_GX statistic (weighted) =  97.92%\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.548\n                Ruecker's Q for heterogeneity; chi2(71) = 170.11 (p =  0.0000)\n                             I-squared statistic = 58.3% (95% CI 45.8%, 67.8%)\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n       slope |   .6173131   .1034573     5.97   0.000     .4145405    .8200858\n       _cons |  -.0087706   .0054812    -1.60   0.110    -.0195136    .0019723\n------------------------------------------------------------------------------\n\n\nMR-Egger using a t-distribution for inference (p-values) & CI limits.\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, tdist\n\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.548\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      t    P>|t|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n       slope |   .6173131   .1034573     5.97   0.000     .4110251    .8236012\n       _cons |  -.0087706   .0054812    -1.60   0.114    -.0196998    .0021585\n------------------------------------------------------------------------------\n\n\nMR-Egger using the radial formulation.\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, radial\n\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.547\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nradialGD     |\n    radialGP |    .642582   .1157871     5.55   0.000     .4156434    .8695205\n       _cons |  -.5737301   .3545658    -1.62   0.106    -1.268666    .1212062\n------------------------------------------------------------------------------\n\n\nMR-Egger using the radial formulation and reporting heterogeneity (Rucker’s) Q-test.\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, radial heterogi\n\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.547\n                Ruecker's Q for heterogeneity; chi2(71) = 169.98 (p =  0.0000)\n                             I-squared statistic = 58.2% (95% CI 45.8%, 67.8%)\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nradialGD     |\n    radialGP |    .642582   .1157871     5.55   0.000     .4156434    .8695205\n       _cons |  -.5737301   .3545658    -1.62   0.106    -1.268666    .1212062\n------------------------------------------------------------------------------"
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mreggersimex-examples",
    "href": "examples/mrrobust-examples/index.html#mreggersimex-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mreggersimex examples",
    "text": "mreggersimex examples\nSIMEX suppressing bootstrapped SEs (for speed - remove the noboot option to obtain SEs).\n\nmreggersimex chdbeta ldlcbeta [aw=1/chdse^2] if sel1==1, gxse(ldlcse) seed(12345) noboot\nqui gr export mreggersimex-plot.svg, width(600) replace\n\n                                                      Number of genotypes = 73\n                                                    Bootstrap replications = 0\n                                                  Simulation replications = 50\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n       slope |   .6256194          .        .       .            .           .\n       _cons |  -.0089987          .        .       .            .           .\n------------------------------------------------------------------------------\n\n\n\n\n\n\n\nSIMEX plots for the MR-Egger model."
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mreggerplot-examples",
    "href": "examples/mrrobust-examples/index.html#mreggerplot-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mreggerplot examples",
    "text": "mreggerplot examples\n\nmreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1\nqui gr export mreggerplot.svg, width(600) replace\n\n\n\n\n\n\n\n\n\nScatter plot showing the genotype summary level data points and the fitted MR-Egger model."
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mrmedian-examples",
    "href": "examples/mrrobust-examples/index.html#mrmedian-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mrmedian examples",
    "text": "mrmedian examples\nWeighted median estimator.\n\nmrmedian chdbeta chdse ldlcbeta ldlcse if sel1==1, weighted\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4582573   .0633137     7.24   0.000     .3341648    .5823499\n------------------------------------------------------------------------------"
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mrmodal-examples",
    "href": "examples/mrrobust-examples/index.html#mrmodal-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mrmodal examples",
    "text": "mrmodal examples\n\nmrmodalplot chdbeta chdse ldlcbeta ldlcse if sel1==1, seed(12345)\nqui gr export mrmodalplot.svg, width(600) replace\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                     Phi = .25\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4198713   .2267297     1.85   0.064    -.0245107    .8642533\n------------------------------------------------------------------------------\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                      Phi = .5\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4218667   .1981169     2.13   0.033     .0335647    .8101688\n------------------------------------------------------------------------------\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4917353   .1356432     3.63   0.000     .2258796     .757591\n------------------------------------------------------------------------------\n\n\n\n\n\n\n\nDensities of the IV estimates using different values of the phi parameter.\n\n\n\n\nSimple mode estimator.\n\nmrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4917353   .1276278     3.85   0.000     .2415894    .7418812\n------------------------------------------------------------------------------\n\n\nWeighted mode estimator.\n\nmrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1, weighted\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4789702   .0663145     7.22   0.000     .3489963    .6089441\n------------------------------------------------------------------------------\n\n\nSimple mode estimator with NOME assumption.\n\nmrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1, nome\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4917353   .1266936     3.88   0.000     .2434204    .7400501\n------------------------------------------------------------------------------"
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#mrfunnel-examples",
    "href": "examples/mrrobust-examples/index.html#mrfunnel-examples",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "mrfunnel examples",
    "text": "mrfunnel examples\n\nmrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1, xlrange(0 10)\nqui gr export mrfunnel.svg, width(600) replace\n\n\n\n\n\n\n\n\n\nExample funnel plot."
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#leave-one-out-analysis",
    "href": "examples/mrrobust-examples/index.html#leave-one-out-analysis",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "Leave one out analysis",
    "text": "Leave one out analysis\nCreate a smaller subset of data.\n\ngen byte sel2 = (ldlcp2 < 1e-25)\n\n\n\n\nPerform leave one out analysis using the IVW estimator\n\nmrleaveoneout chdbeta ldlcbeta if sel2==1, gyse(chdse) genotype(rsid) noprint\nqui gr export mrleaveoneout-plot-01.svg, width(600) replace\n\n\n\n\n\n\n\n\n\nPlot showing leave one (genotype) out at a time analysis for the IVW estimate.\n\n\n\n\nPerform leave one out analysis using MVMR collecting the estimate for LDL-c.\n\nmrleaveoneout chdbeta ldlcbeta hdlcbeta tgbeta if sel2==1, ///\n    method(mvmr) gyse(chdse) genotype(rsid) noprint\nqui gr export mrleaveoneout-plot-02.svg, width(600) replace\n\n\n\n\n\n\nPlot showing leave one (genotype) out at a time analysis for the MVMR estimate."
  },
  {
    "objectID": "examples/mrrobust-examples/index.html#references",
    "href": "examples/mrrobust-examples/index.html#references",
    "title": "Examples from helpfiles in the mrrobust package",
    "section": "References",
    "text": "References\n\n\nBowden, Jack, George Davey Smith, Philip C Haycock, and Stephen Burgess. 2016. “Consistent estimation in Mendelian randomization with some invalid instruments using a weighted median estimator.” Genetic Epidemiology 40 (4): 304–14. https://doi.org/10.1002/gepi.21965.\n\n\nDo, Ron, Cristen J Willer, Ellen M Schmidt, Sebanti Sengupta, Chi Gao, Gina M Peloso, Stefan Gustafsson, et al. 2013. “Common Variants Associated with Plasma Triglycerides and Risk for Coronary Artery Disease.” Nature Genetics 45 (11): 1345–52. https://doi.org/10.1038/ng.2795."
  },
  {
    "objectID": "examples/mvcommands-example/index.html",
    "href": "examples/mvcommands-example/index.html",
    "title": "mrrobust",
    "section": "",
    "text": "Read in the Do et al. (2013) example dataset.\n\nuse https://raw.github.com/remlapmot/mrrobust/master/dodata, clear\n\n\n\n\nSelect observations (p-value with LDL-C < 10-8)\n\ngen byte sel1 = (ldlcp2 < 1e-8)\n\n\n\n\n\n\nFit the multivariable inverse-variance weighted (MV-IVW a.k.a. multivariable Mendelian randomization, MVMR) estimator with phenotypes LDL-c and HDL-c (Burgess, Dudbridge, and Thompson 2015).\n\nmrmvivw chdbeta ldlcbeta hdlcbeta [aw=1/(chdse^2)] if sel1==1\n\n                                                      Number of genotypes = 73\n                                                      Number of phenotypes = 2\n                                                Standard errors: Random effect\n                                              Residual standard error =  1.514\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |   .4670719   .0581901     8.03   0.000     .3530214    .5811224\n    hdlcbeta |  -.2930048   .1211822    -2.42   0.016    -.5305175   -.0554921\n------------------------------------------------------------------------------\n\n\nAdditionally include a third phenotype – triglycerides.\n\nmrmvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1\n\n                                                      Number of genotypes = 73\n                                                      Number of phenotypes = 3\n                                                Standard errors: Random effect\n                                              Residual standard error =  1.490\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |     .42862   .0609661     7.03   0.000     .3091286    .5481113\n    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4506189    .0622211\n      tgbeta |   .2260456   .1232828     1.83   0.067    -.0155842    .4676755\n------------------------------------------------------------------------------\n\n\nReport the QA statistic for instrument validity and the conditional F-statistics for instrument strength for each phenotype (Sanderson et al. 2019; Sanderson, Spiller, and Bowden 2021).\n\nmrmvivw chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, gxse(ldlcse hdlcse tgse)\n\n                                                      Number of genotypes = 73\n                                                      Number of phenotypes = 3\n                                                Standard errors: Random effect\n                                              Residual standard error =  1.490\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |     .42862   .0609661     7.03   0.000     .3091286    .5481113\n    hdlcbeta |  -.1941989   .1308289    -1.48   0.138    -.4506189    .0622211\n      tgbeta |   .2260456   .1232828     1.83   0.067    -.0155842    .4676755\n------------------------------------------------------------------------------\n Q_A statistic for instrument validity; chi2(70) = 152.88 (p =  0.0000)\n Conditional F-statistics for instrument strength:\n F_x1 = 130.31   (ldlcbeta)\n F_x2 = 36.29    (hdlcbeta)\n F_x3 = 40.44    (tgbeta)\n\n\n\n\n\nFit MVMR-Egger regression (Rees, Wood, and Burgess 2017), by default orienting the model to the first phenotype in the main varlist.\n\nmrmvegger chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1\n\n                                       MVMR-Egger model oriented wrt: ldlcbeta\n                                                      Number of genotypes = 73\n                                                      Number of phenotypes = 3\n                                              Residual standard error =  1.469\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |   .5672993   .1002611     5.66   0.000      .370791    .7638075\n    hdlcbeta |  -.1364113   .1332727    -1.02   0.306    -.3976209    .1247983\n      tgbeta |   .2739803   .1246927     2.20   0.028     .0295871    .5183735\n       _cons |  -.0093655   .0054187    -1.73   0.084     -.019986     .001255\n------------------------------------------------------------------------------\n\n\nWe can also orient the model with respect to HDL-C instead of LDL-C.\n\nmrmvegger chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, orient(2)\n\n                                       MVMR-Egger model oriented wrt: hdlcbeta\n                                                      Number of genotypes = 73\n                                                      Number of phenotypes = 3\n                                              Residual standard error =  1.501\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |   .4286398   .0614056     6.98   0.000      .308287    .5489926\n    hdlcbeta |  -.1989637   .1541909    -1.29   0.197    -.5011723    .1032449\n      tgbeta |   .2256794   .1243221     1.82   0.069    -.0179875    .4693463\n       _cons |   .0002155   .0036218     0.06   0.953     -.006883    .0073141\n------------------------------------------------------------------------------\n\n\nOr we can orient the model with respect to triglycerides instead of LDL-C.\n\nmrmvegger chdbeta ldlcbeta hdlcbeta tgbeta [aw=1/(chdse^2)] if sel1==1, orient(3)\n\n                                         MVMR-Egger model oriented wrt: tgbeta\n                                                      Number of genotypes = 73\n                                                      Number of phenotypes = 3\n                                              Residual standard error =  1.499\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |   .4203073   .0660026     6.37   0.000     .2909447      .54967\n    hdlcbeta |  -.1903089   .1321536    -1.44   0.150    -.4493252    .0687075\n      tgbeta |   .2065651   .1365427     1.51   0.130    -.0610537     .474184\n       _cons |   .0013499    .003951     0.34   0.733    -.0063939    .0090936\n------------------------------------------------------------------------------\n\n\n\n\n\n\n\nBurgess, S, F Dudbridge, and SG Thompson. 2015. “Multivariable Mendelian randomization: the use of pleiotropic genetic variants to estimate causal effects.” American Journal of Epidemiology 181 (4): 251–60. https://doi.org/10.1093/aje/kwu283.\n\n\nDo, Ron, Cristen J Willer, Ellen M Schmidt, Sebanti Sengupta, Chi Gao, Gina M Peloso, Stefan Gustafsson, et al. 2013. “Common Variants Associated with Plasma Triglycerides and Risk for Coronary Artery Disease.” Nature Genetics 45 (11): 1345–52. https://doi.org/10.1038/ng.2795.\n\n\nRees, J, A Wood, and S Burgess. 2017. “Extending the MR-Egger method for multivariable Mendelian randomization to correct for both measured and unmeasured pleiotropy.” Statistics in Medicine 36 (29): 4705–18. https://doi.org/10.1002/sim.7492.\n\n\nSanderson, E, G Davey Smith, F Windmeijer, and J Bowden. 2019. “An examination of multivariable Mendelian randomization in the single-sample and two-sample summary data settings.” International Journal of Epidemiology 48 (3): 713–27. https://doi.org/10.1093/ije/dyy262.\n\n\nSanderson, E, W Spiller, and J Bowden. 2021. “Testing and correcting for weak and pleiotropic instruments in two-sample multivariable Mendelian randomization.” Statistics in Medicine 40 (25): 5434–52. https://doi.org/10.1002/sim.9133."
  },
  {
    "objectID": "examples/save-estimates/index.html",
    "href": "examples/save-estimates/index.html",
    "title": "mrrobust",
    "section": "",
    "text": "This example shows how to conveniently save and export your estimates using the r(table) matrix that is now returned by each command.\n\n\n\nuse https://raw.github.com/remlapmot/mrrobust/master/dodata, clear\n\n\n\n\nSelect observations (p-value with exposure < 10-8)\n\ngen byte sel1 = (ldlcp2 < 1e-8)\n\n\n\n\n\n\n\nIVW (with fixed effect standard errors)\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, ivw fe\nmat ivw = r(table)\n\n                                                      Number of genotypes = 73\n                                      Residual standard error constrained at 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n    ldlcbeta |   .4815055    .038221    12.60   0.000     .4065938    .5564173\n------------------------------------------------------------------------------\n\n\nMR-Egger (with SEs using an unconstrained residual variance)\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1\nmat mregger = r(table)\n\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.548\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nchdbeta      |\n       slope |   .6173131   .1034573     5.97   0.000     .4145405    .8200858\n       _cons |  -.0087706   .0054812    -1.60   0.110    -.0195136    .0019723\n------------------------------------------------------------------------------\n\n\nMR-Egger using the radial formulation\n\nmregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, radial\nmat radial = r(table)\n\n                                                      Number of genotypes = 73\n                                              Residual standard error =  1.547\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\nradialGD     |\n    radialGP |    .642582   .1157871     5.55   0.000     .4156434    .8695205\n       _cons |  -.5737301   .3545658    -1.62   0.106    -1.268666    .1212062\n------------------------------------------------------------------------------\n\n\nWeighted mode estimator\n\nmrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1, weighted\nmat mode = r(table)\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n                                                                       Phi = 1\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4789702   .0663145     7.22   0.000     .3489963    .6089441\n------------------------------------------------------------------------------\n\n\nWeighted median estimator\n\nmrmedian chdbeta chdse ldlcbeta ldlcse if sel1==1, weighted\nmat median = r(table)\n\n                                                      Number of genotypes = 73\n                                                           Replications = 1000\n------------------------------------------------------------------------------\n             | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n        beta |   .4582573   .0653722     7.01   0.000     .3301302    .5863845\n------------------------------------------------------------------------------\n\n\n\n\n\nCheck our matrices\n\nmat dir\nmat list ivw\nmat list mregger\nmat list radial\nmat list mode\nmat list median\n\n       median[9,1]\n         mode[9,1]\n       radial[9,2]\n      mregger[9,2]\n          ivw[9,1]\n\n\nivw[9,1]\n          chdbeta:\n         ldlcbeta\n     b  .48150551\n    se  .03822098\n     z  12.597937\npvalue  2.167e-36\n    ll  .40659377\n    ul  .55641726\n    df          .\n  crit   1.959964\n eform          0\n\n\nmregger[9,2]\n           chdbeta:    chdbeta:\n             slope       _cons\n     b   .61731315  -.00877065\n    se   .10345735   .00548118\n     z   5.9668371    -1.60014\npvalue   2.419e-09   .10956752\n    ll   .41454047  -.01951356\n    ul   .82008582   .00197226\n    df           .           .\n  crit    1.959964    1.959964\n eform           0           0\n\n\nradial[9,2]\n          radialGD:   radialGD:\n          radialGP       _cons\n     b   .64258196  -.57373006\n    se   .11578709   .35456584\n     z   5.5496858    -1.61812\npvalue   2.862e-08   .10563675\n    ll   .41564344  -1.2686663\n    ul   .86952048   .12120621\n    df           .           .\n  crit    1.959964    1.959964\n eform           0           0\n\n\nmode[9,1]\n             beta\n     b   .4789702\n    se  .06631445\n     z   7.222712\npvalue  5.096e-13\n    ll  .34899626\n    ul  .60894415\n    df          .\n  crit   1.959964\n eform          0\n\n\nmedian[9,1]\n             beta\n     b  .45825733\n    se   .0653722\n     z  7.0099725\npvalue  2.384e-12\n    ll  .33013017\n    ul  .58638448\n    df          .\n  crit   1.959964\n eform          0\n\n\nCombined into single matrix\n\nmat output = (ivw, mregger, radial, mode, median)\nmat colnames output = ivw_beta mregger_beta mregger_cons ///\n    radial_beta radial_cons mode_beta median_beta\nmat coleq output = \"\" \"\" \"\" \"\" \"\" \"\" \"\"\nmat output = output'\nmat list output, format(%4.3f)\n\noutput[7,9]\n                   b      se       z  pvalue      ll      ul      df    crit   eform\n    ivw_beta   0.482   0.038  12.598   0.000   0.407   0.556       .   1.960   0.000\nmregger_beta   0.617   0.103   5.967   0.000   0.415   0.820       .   1.960   0.000\nmregger_cons  -0.009   0.005  -1.600   0.110  -0.020   0.002       .   1.960   0.000\n radial_beta   0.643   0.116   5.550   0.000   0.416   0.870       .   1.960   0.000\n radial_cons  -0.574   0.355  -1.618   0.106  -1.269   0.121       .   1.960   0.000\n   mode_beta   0.479   0.066   7.223   0.000   0.349   0.609       .   1.960   0.000\n median_beta   0.458   0.065   7.010   0.000   0.330   0.586       .   1.960   0.000\n\n\nExport matrix to dataset\n\ndrop _all\nsvmat output, names(col)\nlocal rownames : rownames output\ndi \"`rownames'\"\ntokenize `rownames'\ngen str15 estimate = \"\"\nforvalues i = 1/7 {\n    replace estimate = \"``i''\" in `i'\n}\n\nShow dataset\n\nlist estimate b se z pvalue ll ul, clean noobs\n\n        estimate           b         se          z     pvalue          ll         ul  \n        ivw_beta    .4815055    .038221   12.59794   2.17e-36    .4065938   .5564172  \n    mregger_beta    .6173131   .1034573   5.966837   2.42e-09    .4145405   .8200858  \n    mregger_cons   -.0087707   .0054812   -1.60014   .1095675   -.0195136   .0019723  \n     radial_beta    .6425819   .1157871   5.549686   2.86e-08    .4156434   .8695205  \n     radial_cons   -.5737301   .3545658   -1.61812   .1056367   -1.268666   .1212062  \n       mode_beta    .4789702   .0663145   7.222712   5.10e-13    .3489963   .6089441  \n     median_beta    .4582573   .0653722   7.009973   2.38e-12    .3301302   .5863845  \n\n\nSave dataset\nsave myestimates, replace\nExport as tab-delimited textfile\nexport delimited using myestimates.txt, delimiter(tab) replace"
  },
  {
    "objectID": "examples/markstat-call-R-example/index.html",
    "href": "examples/markstat-call-R-example/index.html",
    "title": "mrrobust",
    "section": "",
    "text": "This example shows how to run R and Stata code within the same Stata Markdown (.stmd) script. The general approach is detailed on the Stata Markdown website here and here.\nThis means that we can use the functions provided by the TwoSampleMR package to obtain data from MR-Base (Hemani et al. 2018).\nBefore you start please install the following two Stata packages from the SSC archive, so in Stata issue the following commands (I have commented them out because I have already installed them).\nssc install whereis\nssc install markstat\n\n\n\nThe following is the example Stata Markdown document.\n---\ntitle: Using mrrobust in a Markstat document example\n---\n\nWe first need to register the R executable with Stata.\n```s\nif c(os) == \"Windows\" local rpath \"C:\\\\Program Files\\\\R\\\\R-4.3.0\\\\bin\\\\x64\\\\R.exe\"\nelse if c(os) == \"Unix\" local rpath \"/usr/bin/R\"\nelse local rpath \"/usr/local/bin/R\"\nwhereis R \"`rpath'\"\n```\n\n\nNext we have an R code chunk in which we install the required packages in R.\n```r\ninstall.packages(\"remotes\")\nremotes::install_github(\"MRCIEU/TwoSampleMR\")\nremotes::install_github(\"MRCIEU/MRInstruments\")\n```\n\n## Extracting data from MR-Base\n\nWe will be running the script from the MR-Base paper \n([Hemani et al., 2018](https://doi.org/10.7554/eLife.34408)). \nThe R code we will use is from \n[here](https://raw.githubusercontent.com/explodecomputer/mr-base-methods-paper/master/scripts/ldl-chd.R).\n\nFirst, we load the packages into our R session.\nNote that the **foreign** package provides the \n`write.dta()` function which we will use to save the data in Stata format.\n```r\nlibrary(TwoSampleMR)\nlibrary(MRInstruments)\nlibrary(foreign)\n```\n\nOur edited version of the code starts by reading in some code\nto generate a set of plots in R.\n```r\nsource(\"mrplots.R\")\n```\n\nWe can access the data using the **MRInstruments** package.\n```r\ndata(gwas_catalog)\n\n# Get published SNPs for LDL cholesterol\nldl_snps <- \n  subset(gwas_catalog, \n    grepl(\"LDL choles\", Phenotype) & Author == \"Willer CJ\")$SNP\n\n# Extract from GLGC dataset\nexposure <- \n  convert_outcome_to_exposure(\n    extract_outcome_data(ldl_snps, \"ieu-a-300\"))\n\n# Get outcome data from Cardiogram 2015\noutcome <- extract_outcome_data(exposure$SNP, \"ieu-a-7\")\n\n# Harmonise exposure and outcome datasets\n# Assume alleles are on the forward strand\ndat <- harmonise_data(exposure, outcome, action = 1)\n```\nAt this point we have our harmonised genotype-exposure and \ngenotype-outcome association data saved in an object in our \nR session called `dat`.\n\nThe next two code chunks perform the analysis in R.\n```r\n# Perform MR\nmr(dat)\nmr_heterogeneity(dat)\ndat$exposure <- \"LDL cholesterol\"\ndat$outcome <- \"Coronary heart disease\"\n\n# Label outliers and create plots\ndat$labels <- dat$SNP\ndat$labels[! dat$SNP %in% c(\"rs11065987\", \"rs1250229\", \"rs4530754\")] <- NA\n```\n\n```r\npng(\"ldl-chd.png\", width=1000, height=1000)\nmr_plots(dat)\ndev.off()\n```\n\n![Plots generated by the TwoSampleMR R package.](ldl-chd.png)\n\nWe now save our `dat` object as a Stata dataset.\n```r\nwrite.dta(dat, file = \"dat.dta\")\n```\n\n## Performing the analysis using mrrobust in Stata\n\nWe now switch from using R code chunks to Stata code chunks.\nWe read the data into Stata and list the variable names\n(note any `.` in the colnames of `dat` have been replaced with `_`).\n```s\nuse dat, clear\nds, v(28)\ndi _N\n```\n\nWe can then run the IVW model using `mregger` with multiplicative\nstandard errors.\n```s\nmregger beta_outcome beta_exposure [aw=1/(se_outcome^2)], ivw\n```\n\nIt is helpful to view the forest plot of genotype specific IV estimates.\n```s\nmrforest beta_outcome se_outcome beta_exposure se_exposure, ivid(SNP) ///\n    xlabel(-3,-2,-1,0,1,2,3)\ngraph export ldl-chd-mrforest.svg, width(600) replace\n```\n\n![Forest plot of genotype specific IV estimates.](ldl-chd-mrforest.svg)\n\nWe can visualise this model with `mreggerplot`.\n```s\nmreggerplot beta_outcome se_outcome beta_exposure se_exposure\ngraph export ldl-chd-mreggerplot.svg, width(600) replace\n```\n\n![Plot of the MR-Egger model.](ldl-chd-mreggerplot.svg)\n\nWe then fit the MR-Egger, median, and modal based estimators.\n```s\nmregger beta_outcome beta_exposure [aw=1/(se_outcome^2)]\n```\n\n```s\nmrmedian beta_outcome se_outcome beta_exposure se_exposure, weighted\n```\n\n```s\nmrmodal beta_outcome se_outcome beta_exposure se_exposure, weighted\n```\nAnd we could continue with additional Stata code (or indeed R code) as we liked.\nNote to run this .stmd file in Stata we do so with the following command (specifying additional options as required, see help markstat for more information).\nmarkstat using markstat-call-R-example\n\n\n\n\n\nHemani, Gibran, Jie Zheng, Benjamin Elsworth, Kaitlin H Wade, Valeriia Haberland, Denis Baird, Charles Laurin, et al. 2018. “The MR-Base platform supports systematic causal inference across the human phenome.” eLife 7: e34408. https://doi.org/10.7554/eLife.34408."
  }
]